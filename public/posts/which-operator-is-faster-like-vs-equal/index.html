<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Which operator is faster: like vs = | Khanh's Blog</title>
<meta name=keywords content="database"><meta name=description content="Explain
Explaining the query will help you to estimate how expensive your query is and which query plan will be used.


1
2
3
4
5
6


khanh=# explain select g from grades where g = 100;
                                  QUERY PLAN
-------------------------------------------------------------------------------
 Index Only Scan using g_index on grades  (cost=0.42..97.55 rows=4636 width=4)
   Index Cond: (g = 100)
(2 rows)


So, this query will use Index-Only-Scan. The cost of the query is ranging from 0.42 to 97.55, 4636 is number of estimated return rows, width is size of return data in byte."><meta name=author content="Me"><link rel=canonical href=http://localhost:1313/posts/which-operator-is-faster-like-vs-equal/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/which-operator-is-faster-like-vs-equal/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Which operator is faster: like vs ="><meta property="og:description" content="Explain
Explaining the query will help you to estimate how expensive your query is and which query plan will be used.


1
2
3
4
5
6


khanh=# explain select g from grades where g = 100;
                                  QUERY PLAN
-------------------------------------------------------------------------------
 Index Only Scan using g_index on grades  (cost=0.42..97.55 rows=4636 width=4)
   Index Cond: (g = 100)
(2 rows)


So, this query will use Index-Only-Scan. The cost of the query is ranging from 0.42 to 97.55, 4636 is number of estimated return rows, width is size of return data in byte."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/which-operator-is-faster-like-vs-equal/"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-21T11:52:42+07:00"><meta property="article:modified_time" content="2022-08-21T11:52:42+07:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Which operator is faster: like vs ="><meta name=twitter:description content="Explain
Explaining the query will help you to estimate how expensive your query is and which query plan will be used.


1
2
3
4
5
6


khanh=# explain select g from grades where g = 100;
                                  QUERY PLAN
-------------------------------------------------------------------------------
 Index Only Scan using g_index on grades  (cost=0.42..97.55 rows=4636 width=4)
   Index Cond: (g = 100)
(2 rows)


So, this query will use Index-Only-Scan. The cost of the query is ranging from 0.42 to 97.55, 4636 is number of estimated return rows, width is size of return data in byte."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Which operator is faster: like vs =","item":"http://localhost:1313/posts/which-operator-is-faster-like-vs-equal/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Which operator is faster: like vs =","name":"Which operator is faster: like vs =","description":"Explain Explaining the query will help you to estimate how expensive your query is and which query plan will be used.\n1 2 3 4 5 6 khanh=# explain select g from grades where g = 100; QUERY PLAN ------------------------------------------------------------------------------- Index Only Scan using g_index on grades (cost=0.42..97.55 rows=4636 width=4) Index Cond: (g = 100) (2 rows) So, this query will use Index-Only-Scan. The cost of the query is ranging from 0.42 to 97.55, 4636 is number of estimated return rows, width is size of return data in byte.\n","keywords":["database"],"articleBody":"Explain Explaining the query will help you to estimate how expensive your query is and which query plan will be used.\n1 2 3 4 5 6 khanh=# explain select g from grades where g = 100; QUERY PLAN ------------------------------------------------------------------------------- Index Only Scan using g_index on grades (cost=0.42..97.55 rows=4636 width=4) Index Cond: (g = 100) (2 rows) So, this query will use Index-Only-Scan. The cost of the query is ranging from 0.42 to 97.55, 4636 is number of estimated return rows, width is size of return data in byte.\nExplain Analyze Explain analyze will both estimate the complexity of your query and execute the query to get the actual result.\n1 2 3 4 5 6 7 8 9 khanh=# explain analyze select g from grades where g = 100; QUERY PLAN ----------------------------------------------------------------------------------------------------------------------------- Index Only Scan using g_index on grades (cost=0.42..97.55 rows=4636 width=4) (actual time=0.117..49.535 rows=5006 loops=1) Index Cond: (g = 100) Heap Fetches: 0 Planning Time: 0.280 ms Execution Time: 95.587 ms (5 rows) The total time is sum of planning time and execution time: 0.280 + 95.587 ms. The actual number of return rows is 5006 instead of 4636 as estimation. The actual cost is also cheaper than the estimated cost.\nPrepare data We need to prepare some data to compare the speed of like and =.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 CREATE TABLE grades (id serial PRIMARY KEY, g int, name text); CREATE INDEX g_index ON grades(g); INSERT INTO grades (g, name) SELECT random()*100, substring(md5(random()::text), 0, floor(random()*31)::int) FROM generate_series(0, 1000000); VACUUM (ANALYZE, VERBOSE, FULL); We will create a table with only two columns, and insert 1 million random rows into that table.\nComparing on non-index column First, I want to test = operator on column name:\n1 2 3 4 5 6 7 8 9 10 11 12 khanh=# explain analyze select * from grades where name = '00d4e4727e671'; QUERY PLAN ---------------------------------------------------------------------------------------------------------------------- Gather (cost=1000.00..12946.94 rows=6 width=23) (actual time=45.986..47.617 rows=1 loops=1) Workers Planned: 2 Workers Launched: 2 -\u003e Parallel Seq Scan on grades (cost=0.00..11946.34 rows=2 width=23) (actual time=31.551..31.573 rows=0 loops=3) Filter: (name = '00d4e4727e671'::text) Rows Removed by Filter: 333333 Planning Time: 0.112 ms Execution Time: 47.783 ms (8 rows) This query we use like:\n1 2 3 4 5 6 7 8 9 10 11 12 khanh=# explain analyze select * from grades where name like '00d4e4727e671'; QUERY PLAN ---------------------------------------------------------------------------------------------------------------------- Gather (cost=1000.00..12946.94 rows=6 width=23) (actual time=45.363..47.072 rows=1 loops=1) Workers Planned: 2 Workers Launched: 2 -\u003e Parallel Seq Scan on grades (cost=0.00..11946.34 rows=2 width=23) (actual time=29.736..29.748 rows=0 loops=3) Filter: (name ~~ '00d4e4727e671'::text) Rows Removed by Filter: 333333 Planning Time: 0.174 ms Execution Time: 47.209 ms (8 rows) There are not much different between = and like without ‘%’. let’s add % to the query:\n1 2 3 4 5 6 7 8 9 10 11 12 khanh=# explain analyze select * from grades where name like '%00d4e4727e671%'; QUERY PLAN ----------------------------------------------------------------------------------------------------------------------- Gather (cost=1000.00..12955.24 rows=89 width=23) (actual time=58.162..60.058 rows=1 loops=1) Workers Planned: 2 Workers Launched: 2 -\u003e Parallel Seq Scan on grades (cost=0.00..11946.34 rows=37 width=23) (actual time=45.619..45.630 rows=0 loops=3) Filter: (name ~~ '%00d4e4727e671%'::text) Rows Removed by Filter: 333333 Planning Time: 0.370 ms Execution Time: 60.164 ms (8 rows) The execution time is a bit longer than before but not too much. 60ms compare to 47ms.\nComparing on index column Let’s create a new index on name column:\n1 2 3 khanh=# CREATE INDEX name_index ON grades(name); CREATE INDEX khanh=# Query with = operator:\n1 2 3 4 5 6 7 8 9 10 11 khanh=# explain analyze select * from grades where name = '00d4e4727e671'; QUERY PLAN ------------------------------------------------------------------------------------------------------------------- Bitmap Heap Scan on grades (cost=4.47..28.01 rows=6 width=23) (actual time=0.101..0.178 rows=1 loops=1) Recheck Cond: (name = '00d4e4727e671'::text) Heap Blocks: exact=1 -\u003e Bitmap Index Scan on name_index (cost=0.00..4.47 rows=6 width=0) (actual time=0.065..0.083 rows=1 loops=1) Index Cond: (name = '00d4e4727e671'::text) Planning Time: 0.986 ms Execution Time: 0.376 ms (7 rows) After adding a index on name column, the query time is improve quite a lot. 47ms without an index, 1ms with an index. Here you can see the database use Bitmap index scan on name_index, so it actually use the index that we just create to speed up the query.\nNext we take a look on whether the index improve query time on like operator:\n1 2 3 4 5 6 7 8 9 10 11 12 khanh=# explain analyze select * from grades where name like '%00d4e4727e671%'; QUERY PLAN ----------------------------------------------------------------------------------------------------------------------- Gather (cost=1000.00..12955.24 rows=89 width=23) (actual time=52.171..53.985 rows=1 loops=1) Workers Planned: 2 Workers Launched: 2 -\u003e Parallel Seq Scan on grades (cost=0.00..11946.34 rows=37 width=23) (actual time=41.987..41.998 rows=0 loops=3) Filter: (name ~~ '%00d4e4727e671%'::text) Rows Removed by Filter: 333333 Planning Time: 0.372 ms Execution Time: 54.188 ms (8 rows) The query time is roughly 54 ms, so it means that the index don’t improve query time if you use like operator, in other words, index don’t involve to like operator. The database is still need to perform a sequence scan to scan all rows in table to find the expected one.\nThat is understandable, because when we use the pattern %search_string%, the database have no choice than loop through the whole table and perform comparing one by one.\nBut, what about pattern text%, you only put % at the end of search string, from my understanding, the database can use index to compare in this case.\n1 2 3 4 5 6 7 8 9 10 11 12 postgres=# explain analyze select * from grades where name like '00d4e4727e671%'; QUERY PLAN ----------------------------------------------------------------------------------------------------------------------- Gather (cost=1000.00..12953.24 rows=89 width=23) (actual time=101.556..107.356 rows=0 loops=1) Workers Planned: 2 Workers Launched: 2 -\u003e Parallel Seq Scan on grades (cost=0.00..11944.34 rows=37 width=23) (actual time=32.084..32.085 rows=0 loops=3) Filter: (name ~~ '00d4e4727e671%'::text) Rows Removed by Filter: 333334 Planning Time: 2.530 ms Execution Time: 107.742 ms (8 rows) This is weird, the database still perform and expensive sequence scan.\nAfter a while of searching on the internet, I found another option when creating index on text column, it is text_pattern_ops.\n1 2 DROP INDEX IF EXISTS name_index; CREATE INDEX name_index ON grades (name text_pattern_ops); Let’s see if the new index improve the query time:\n1 2 3 4 5 6 7 8 9 postgres=# explain analyze select * from grades where name like '00d4e4727e671%'; QUERY PLAN --------------------------------------------------------------------------------------------------------------------- Index Scan using name_index on grades (cost=0.42..8.45 rows=89 width=23) (actual time=0.172..0.174 rows=0 loops=1) Index Cond: ((name ~\u003e=~ '00d4e4727e671'::text) AND (name ~\u003c~ '00d4e4727e672'::text)) Filter: (name ~~ '00d4e4727e671%'::text) Planning Time: 4.601 ms Execution Time: 0.475 ms (5 rows) It does! The database uses index scan instead of sequence scan like before, query time is significantly reduced.\nI also did tests on patterns like %search_string% or %search_string, as expected, the text_pattern_ops index can’t help. To understand why text_pattern_ops helps the search with pattern search_string%, please read the links that are attached in the References section below.\nConclusion If the column doesn’t have an index, query times of = and like are quite similar.\nIf the column has an index, it reduces significant query time of = operator. whereas, the like operator can’t use index to improve query time.\nBut there is an index option that lets database using index while performing the like operator, it is text_pattern_ops. With this option on, you can use like operator with a pattern like search_string%.\nReferences https://thoughtbot.com/blog/reading-an-explain-analyze-query-plan https://dba.stackexchange.com/questions/53811/why-would-you-index-text-pattern-ops-on-a-text-column https://dba.stackexchange.com/questions/10694/pattern-matching-with-like-similar-to-or-regular-expressions/10696#10696 https://dba.stackexchange.com/questions/240930/postgresql-difference-between-collations-c-and-c-utf-8\n","wordCount":"1223","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2022-08-21T11:52:42+07:00","dateModified":"2022-08-21T11:52:42+07:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/which-operator-is-faster-like-vs-equal/"},"publisher":{"@type":"Organization","name":"Khanh's Blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Khanh's Blog (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Khanh's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/archives/ title=Archive><span>Archive</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Which operator is faster: like vs =</h1><div class=post-meta><span title='2022-08-21 11:52:42 +0700 +07'>August 21, 2022</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1223 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/khanh1998/khanh1998.github.io/blob/main/content/posts/which-operator-is-faster-like-vs-equal.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#explain>Explain</a></li><li><a href=#explain-analyze>Explain Analyze</a></li><li><a href=#prepare-data>Prepare data</a></li><li><a href=#comparing-on-non-index-column>Comparing on non-index column</a></li><li><a href=#comparing-on-index-column>Comparing on index column</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><h2 id=explain>Explain<a hidden class=anchor aria-hidden=true href=#explain>#</a></h2><p>Explaining the query will help you to estimate how expensive your query is and which query plan will be used.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>khanh</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>100</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                  </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=k>Index</span><span class=w> </span><span class=k>Only</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>using</span><span class=w> </span><span class=n>g_index</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>42</span><span class=p>..</span><span class=mi>97</span><span class=p>.</span><span class=mi>55</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>4636</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>Index</span><span class=w> </span><span class=n>Cond</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=k>g</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>So, this query will use <em>Index-Only-Scan</em>. The <strong>cost</strong> of the query is ranging from 0.42 to 97.55, 4636 is number of estimated return <strong>rows</strong>, <strong>width</strong> is size of return data in byte.</p><h2 id=explain-analyze>Explain Analyze<a hidden class=anchor aria-hidden=true href=#explain-analyze>#</a></h2><p>Explain analyze will both estimate the complexity of your query and execute the query to get the actual result.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8>8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>khanh</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>analyze</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=k>g</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>100</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                                         </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------------------------------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=k>Index</span><span class=w> </span><span class=k>Only</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>using</span><span class=w> </span><span class=n>g_index</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>42</span><span class=p>..</span><span class=mi>97</span><span class=p>.</span><span class=mi>55</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>4636</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>117</span><span class=p>..</span><span class=mi>49</span><span class=p>.</span><span class=mi>535</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>5006</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>Index</span><span class=w> </span><span class=n>Cond</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=k>g</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Heap</span><span class=w> </span><span class=n>Fetches</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Planning</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>280</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Execution</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>95</span><span class=p>.</span><span class=mi>587</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>5</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>The total time is sum of planning time and execution time: 0.280 + 95.587 ms. The actual number of return rows is 5006 instead of 4636 as estimation. The actual cost is also cheaper than the estimated cost.</p><h2 id=prepare-data>Prepare data<a hidden class=anchor aria-hidden=true href=#prepare-data>#</a></h2><p>We need to prepare some data to compare the speed of <code>like</code> and <code>=</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=w> </span><span class=nb>serial</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                       </span><span class=k>g</span><span class=w> </span><span class=nb>int</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=nb>text</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>g_index</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>grades</span><span class=p>(</span><span class=k>g</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=p>(</span><span class=k>g</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>random</span><span class=p>()</span><span class=o>*</span><span class=mi>100</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>substring</span><span class=p>(</span><span class=n>md5</span><span class=p>(</span><span class=n>random</span><span class=p>()::</span><span class=nb>text</span><span class=p>),</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>floor</span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=o>*</span><span class=mi>31</span><span class=p>)::</span><span class=nb>int</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>generate_series</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1000000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>VACUUM</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>VERBOSE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>FULL</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>We will create a table with only two columns, and insert 1 million random rows into that table.</p><h2 id=comparing-on-non-index-column>Comparing on non-index column<a hidden class=anchor aria-hidden=true href=#comparing-on-non-index-column>#</a></h2><p>First, I want to test <code>=</code> operator on column <em>name</em>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>khanh</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>analyze</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;00d4e4727e671&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                                      </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>----------------------------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Gather</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>1000</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>12946</span><span class=p>.</span><span class=mi>94</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>6</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>45</span><span class=p>.</span><span class=mi>986</span><span class=p>..</span><span class=mi>47</span><span class=p>.</span><span class=mi>617</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Planned</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Launched</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-&gt;</span><span class=w>  </span><span class=n>Parallel</span><span class=w> </span><span class=n>Seq</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>11946</span><span class=p>.</span><span class=mi>34</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>2</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>31</span><span class=p>.</span><span class=mi>551</span><span class=p>..</span><span class=mi>31</span><span class=p>.</span><span class=mi>573</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>0</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;00d4e4727e671&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>Rows</span><span class=w> </span><span class=n>Removed</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=mi>333333</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Planning</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>112</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Execution</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>47</span><span class=p>.</span><span class=mi>783</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>8</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>This query we use <code>like</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>khanh</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>analyze</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;00d4e4727e671&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                                      </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>----------------------------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Gather</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>1000</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>12946</span><span class=p>.</span><span class=mi>94</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>6</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>45</span><span class=p>.</span><span class=mi>363</span><span class=p>..</span><span class=mi>47</span><span class=p>.</span><span class=mi>072</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Planned</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Launched</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-&gt;</span><span class=w>  </span><span class=n>Parallel</span><span class=w> </span><span class=n>Seq</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>11946</span><span class=p>.</span><span class=mi>34</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>2</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>29</span><span class=p>.</span><span class=mi>736</span><span class=p>..</span><span class=mi>29</span><span class=p>.</span><span class=mi>748</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>0</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>~~</span><span class=w> </span><span class=s1>&#39;00d4e4727e671&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>Rows</span><span class=w> </span><span class=n>Removed</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=mi>333333</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Planning</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>174</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Execution</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>47</span><span class=p>.</span><span class=mi>209</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>8</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>There are not much different between <code>=</code> and <code>like without ‘%’</code>. let’s add <code>%</code> to the query:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>khanh</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>analyze</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%00d4e4727e671%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                                      </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------------------------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Gather</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>1000</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>12955</span><span class=p>.</span><span class=mi>24</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>89</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>58</span><span class=p>.</span><span class=mi>162</span><span class=p>..</span><span class=mi>60</span><span class=p>.</span><span class=mi>058</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Planned</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Launched</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-&gt;</span><span class=w>  </span><span class=n>Parallel</span><span class=w> </span><span class=n>Seq</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>11946</span><span class=p>.</span><span class=mi>34</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>37</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>45</span><span class=p>.</span><span class=mi>619</span><span class=p>..</span><span class=mi>45</span><span class=p>.</span><span class=mi>630</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>0</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>~~</span><span class=w> </span><span class=s1>&#39;%00d4e4727e671%&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>Rows</span><span class=w> </span><span class=n>Removed</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=mi>333333</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Planning</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>370</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Execution</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>60</span><span class=p>.</span><span class=mi>164</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>8</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>The execution time is a bit longer than before but not too much. 60ms compare to 47ms.</p><h2 id=comparing-on-index-column>Comparing on index column<a hidden class=anchor aria-hidden=true href=#comparing-on-index-column>#</a></h2><p>Let’s create a new index on name column:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>khanh</span><span class=o>=#</span><span class=w> </span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>name_index</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>grades</span><span class=p>(</span><span class=n>name</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>khanh</span><span class=o>=#</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Query with <code>=</code> operator:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>khanh</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>analyze</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;00d4e4727e671&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                                    </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------------------------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Bitmap</span><span class=w> </span><span class=n>Heap</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>4</span><span class=p>.</span><span class=mi>47</span><span class=p>..</span><span class=mi>28</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>6</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>101</span><span class=p>..</span><span class=mi>0</span><span class=p>.</span><span class=mi>178</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>Recheck</span><span class=w> </span><span class=n>Cond</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;00d4e4727e671&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Heap</span><span class=w> </span><span class=n>Blocks</span><span class=p>:</span><span class=w> </span><span class=n>exact</span><span class=o>=</span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-&gt;</span><span class=w>  </span><span class=n>Bitmap</span><span class=w> </span><span class=k>Index</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>name_index</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>4</span><span class=p>.</span><span class=mi>47</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>6</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>065</span><span class=p>..</span><span class=mi>0</span><span class=p>.</span><span class=mi>083</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>Index</span><span class=w> </span><span class=n>Cond</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;00d4e4727e671&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Planning</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>986</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Execution</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>376</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>7</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>After adding a index on name column, the query time is improve quite a lot. 47ms without an index, 1ms with an index. Here you can see the database use <strong>Bitmap index scan</strong> on <em>name_index</em>, so it actually use the index that we just create to speed up the query.</p><p>Next we take a look on whether the index improve query time on like operator:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>khanh</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>analyze</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%00d4e4727e671%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                                      </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------------------------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Gather</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>1000</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>12955</span><span class=p>.</span><span class=mi>24</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>89</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>52</span><span class=p>.</span><span class=mi>171</span><span class=p>..</span><span class=mi>53</span><span class=p>.</span><span class=mi>985</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Planned</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Launched</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-&gt;</span><span class=w>  </span><span class=n>Parallel</span><span class=w> </span><span class=n>Seq</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>11946</span><span class=p>.</span><span class=mi>34</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>37</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>41</span><span class=p>.</span><span class=mi>987</span><span class=p>..</span><span class=mi>41</span><span class=p>.</span><span class=mi>998</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>0</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>~~</span><span class=w> </span><span class=s1>&#39;%00d4e4727e671%&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>Rows</span><span class=w> </span><span class=n>Removed</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=mi>333333</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Planning</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>372</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Execution</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>54</span><span class=p>.</span><span class=mi>188</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>8</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>The query time is roughly 54 ms, so it means that the index don’t improve query time if you use <code>like</code> operator, in other words, index don’t involve to <code>like</code> operator. The database is still need to perform a <code>sequence scan</code> to scan all rows in table to find the expected one.</p><p>That is understandable, because when we use the pattern <code>%search_string%</code>, the database have no choice than loop through the whole table and perform comparing one by one.</p><p>But, what about pattern <code>text%</code>, you only put <code>%</code> at the end of search string, from my understanding, the database can use index to compare in this case.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>postgres</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>analyze</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;00d4e4727e671%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                                      </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------------------------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Gather</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>1000</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>12953</span><span class=p>.</span><span class=mi>24</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>89</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>101</span><span class=p>.</span><span class=mi>556</span><span class=p>..</span><span class=mi>107</span><span class=p>.</span><span class=mi>356</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>0</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Planned</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Workers</span><span class=w> </span><span class=n>Launched</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-&gt;</span><span class=w>  </span><span class=n>Parallel</span><span class=w> </span><span class=n>Seq</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=p>..</span><span class=mi>11944</span><span class=p>.</span><span class=mi>34</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>37</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>32</span><span class=p>.</span><span class=mi>084</span><span class=p>..</span><span class=mi>32</span><span class=p>.</span><span class=mi>085</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>0</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>~~</span><span class=w> </span><span class=s1>&#39;00d4e4727e671%&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=k>Rows</span><span class=w> </span><span class=n>Removed</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=mi>333334</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Planning</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=p>.</span><span class=mi>530</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Execution</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>107</span><span class=p>.</span><span class=mi>742</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>8</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>This is weird, the database still perform and expensive sequence scan.</p><p>After a while of searching on the internet, I found another option when creating index on text column, it is <code>text_pattern_ops</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>name_index</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>name_index</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=n>text_pattern_ops</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s see if the new index improve the query time:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2>2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3>3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4>4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5>5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6>6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7>7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8>8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>postgres</span><span class=o>=#</span><span class=w> </span><span class=k>explain</span><span class=w> </span><span class=k>analyze</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>grades</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;00d4e4727e671%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                                     </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>---------------------------------------------------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=k>Index</span><span class=w> </span><span class=n>Scan</span><span class=w> </span><span class=k>using</span><span class=w> </span><span class=n>name_index</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>grades</span><span class=w>  </span><span class=p>(</span><span class=n>cost</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>42</span><span class=p>..</span><span class=mi>8</span><span class=p>.</span><span class=mi>45</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>89</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=n>actual</span><span class=w> </span><span class=n>time</span><span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>172</span><span class=p>..</span><span class=mi>0</span><span class=p>.</span><span class=mi>174</span><span class=w> </span><span class=k>rows</span><span class=o>=</span><span class=mi>0</span><span class=w> </span><span class=n>loops</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>Index</span><span class=w> </span><span class=n>Cond</span><span class=p>:</span><span class=w> </span><span class=p>((</span><span class=n>name</span><span class=w> </span><span class=o>~&gt;=~</span><span class=w> </span><span class=s1>&#39;00d4e4727e671&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>~&lt;~</span><span class=w> </span><span class=s1>&#39;00d4e4727e672&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>Filter</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>~~</span><span class=w> </span><span class=s1>&#39;00d4e4727e671%&#39;</span><span class=p>::</span><span class=nb>text</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Planning</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>601</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Execution</span><span class=w> </span><span class=n>Time</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>475</span><span class=w> </span><span class=n>ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>5</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>It does! The database uses index scan instead of sequence scan like before, query time is significantly reduced.<br>I also did tests on patterns like <code>%search_string%</code> or <code>%search_string</code>, as expected, the <code>text_pattern_ops</code> index can&rsquo;t help.
To understand why <code>text_pattern_ops</code> helps the search with pattern <code>search_string%</code>, please read the links that are attached in the References section below.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>If the column doesn’t have an index, query times of <code>=</code> and <code>like</code> are quite similar.</p><p>If the column has an index, it reduces significant query time of <code>=</code> operator. whereas, the <code>like</code> operator can’t use index to improve query time.</p><p>But there is an index option that lets database using index while performing the <code>like</code> operator, it is <code>text_pattern_ops</code>. With this option on, you can use <code>like</code> operator with a pattern like <code>search_string%</code>.</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><p><a href=https://thoughtbot.com/blog/reading-an-explain-analyze-query-plan>https://thoughtbot.com/blog/reading-an-explain-analyze-query-plan</a>
<a href=https://dba.stackexchange.com/questions/53811/why-would-you-index-text-pattern-ops-on-a-text-column>https://dba.stackexchange.com/questions/53811/why-would-you-index-text-pattern-ops-on-a-text-column</a>
<a href=https://dba.stackexchange.com/questions/10694/pattern-matching-with-like-similar-to-or-regular-expressions/10696#10696>https://dba.stackexchange.com/questions/10694/pattern-matching-with-like-similar-to-or-regular-expressions/10696#10696</a>
<a href=https://dba.stackexchange.com/questions/240930/postgresql-difference-between-collations-c-and-c-utf-8>https://dba.stackexchange.com/questions/240930/postgresql-difference-between-collations-c-and-c-utf-8</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/database/>Database</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/disjoin-set-union-find/><span class=title>« Prev</span><br><span>Disjoin-Set/Union-Find notes</span>
</a><a class=next href=http://localhost:1313/posts/postgres-timezone/><span class=title>Next »</span><br><span>Postgres Timezone</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Which operator is faster: like vs = on x" href="https://x.com/intent/tweet/?text=Which%20operator%20is%20faster%3a%20like%20vs%20%3d&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwhich-operator-is-faster-like-vs-equal%2f&amp;hashtags=database"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Which operator is faster: like vs = on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwhich-operator-is-faster-like-vs-equal%2f&amp;title=Which%20operator%20is%20faster%3a%20like%20vs%20%3d&amp;summary=Which%20operator%20is%20faster%3a%20like%20vs%20%3d&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fwhich-operator-is-faster-like-vs-equal%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Which operator is faster: like vs = on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwhich-operator-is-faster-like-vs-equal%2f&title=Which%20operator%20is%20faster%3a%20like%20vs%20%3d"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Which operator is faster: like vs = on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwhich-operator-is-faster-like-vs-equal%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Which operator is faster: like vs = on whatsapp" href="https://api.whatsapp.com/send?text=Which%20operator%20is%20faster%3a%20like%20vs%20%3d%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fwhich-operator-is-faster-like-vs-equal%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Which operator is faster: like vs = on telegram" href="https://telegram.me/share/url?text=Which%20operator%20is%20faster%3a%20like%20vs%20%3d&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwhich-operator-is-faster-like-vs-equal%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Which operator is faster: like vs = on ycombinator" href="https://news.ycombinator.com/submitlink?t=Which%20operator%20is%20faster%3a%20like%20vs%20%3d&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwhich-operator-is-faster-like-vs-equal%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//khanh1998.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Khanh's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>