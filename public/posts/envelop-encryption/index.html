<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Envelop Encryption | Khanh1998</title>
<meta name=keywords content="cs,encryption"><meta name=description content="To secure storing sensitive information, a common approach is to use envelope encryption:

A master key (usually managed by a secure KMS)
A row-level key (used to encrypt individual records)
Each row of sensitive data (e.g., credit card information) is encrypted using a unique row key, the row key itself is encrypted using the master key and stored alongside the data in the database.

This setup allows secure key rotation, better isolation, and compliance with security standards."><meta name=author content="Khanh Bui"><link rel=canonical href=https://khanh1998.github.io/posts/envelop-encryption/><meta name=google-site-verification content="Siuz-KNzTaGnjWViVxoA0J6xLTJQtxwpsh9L7HHMNnA"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://khanh1998.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://khanh1998.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://khanh1998.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://khanh1998.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://khanh1998.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://khanh1998.github.io/posts/envelop-encryption/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-Y0MCHJNHTB"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Y0MCHJNHTB")</script><meta property="og:url" content="https://khanh1998.github.io/posts/envelop-encryption/"><meta property="og:site_name" content="Khanh1998"><meta property="og:title" content="Envelop Encryption"><meta property="og:description" content="To secure storing sensitive information, a common approach is to use envelope encryption:
A master key (usually managed by a secure KMS) A row-level key (used to encrypt individual records) Each row of sensitive data (e.g., credit card information) is encrypted using a unique row key, the row key itself is encrypted using the master key and stored alongside the data in the database. This setup allows secure key rotation, better isolation, and compliance with security standards."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-11T20:56:56+07:00"><meta property="article:modified_time" content="2025-04-11T20:56:56+07:00"><meta property="article:tag" content="Cs"><meta property="article:tag" content="Encryption"><meta property="og:image" content="https://khanh1998.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://khanh1998.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Envelop Encryption"><meta name=twitter:description content="To secure storing sensitive information, a common approach is to use envelope encryption:

A master key (usually managed by a secure KMS)
A row-level key (used to encrypt individual records)
Each row of sensitive data (e.g., credit card information) is encrypted using a unique row key, the row key itself is encrypted using the master key and stored alongside the data in the database.

This setup allows secure key rotation, better isolation, and compliance with security standards."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://khanh1998.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Envelop Encryption","item":"https://khanh1998.github.io/posts/envelop-encryption/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Envelop Encryption","name":"Envelop Encryption","description":"To secure storing sensitive information, a common approach is to use envelope encryption:\nA master key (usually managed by a secure KMS) A row-level key (used to encrypt individual records) Each row of sensitive data (e.g., credit card information) is encrypted using a unique row key, the row key itself is encrypted using the master key and stored alongside the data in the database. This setup allows secure key rotation, better isolation, and compliance with security standards.\n","keywords":["cs","encryption"],"articleBody":"To secure storing sensitive information, a common approach is to use envelope encryption:\nA master key (usually managed by a secure KMS) A row-level key (used to encrypt individual records) Each row of sensitive data (e.g., credit card information) is encrypted using a unique row key, the row key itself is encrypted using the master key and stored alongside the data in the database. This setup allows secure key rotation, better isolation, and compliance with security standards.\n1. Data Encryption For an application, generate a single master key (KEK - Key Encryption Key) and store it in a safe place For each row (e.g., credit card), we generate a unique key (DEK - Data Encryption Key) We encrypt row data with its corresponding row key and also encrypt the row key with the master key we usually don’t need to encrypt the entire row of data, just some sensitive fields are enough for the credit card use case, we only need to encrypt the card number, cardholder name, and CVV this keeps the encryption small and fast Store encrypted data and encrypted row key to the database 2. Data Decryption Retrieve encrypted data and encrypted row key from the database Decrypt row key with master key Decrypt row data with row key 3. Where To Store Master Key (KEK) KMS - Key Management Service The safest place to manage the master key KMS is backed by a Hardware Security Module (HSM). HSM is special hardware that helps you to generate and store keys, and encrypt and decrypt data with the generated key. The generated keys will never leave the device, no one knows the key, even the administrators, it also usually comes with data tampering prevention out of the box. Once the master key is created by KMS, you can send row keys to KMS to encrypt it. To decrypt row keys, send the encrypted row keys back to KMS, which will return the decrypted ones. The master key never leaves the HSM. Major cloud providers all support this service If you use KMS from the cloud providers, your master keys are generated and stored securely within their infrastructure. You can even gain more control over security with BYOE - Bring Your Own Encryption, keys now will be generated and stored in your custom HSM devices. If you need absolute security control, host your own KMS service that is backed by HSM. Secrets Manager Not as safe as KMS This service is meant to store API keys, passwords, certificates, and other sensitive data - not master keys (KEK) Since it isn’t backed by HSM, hence it doesn’t support key generation, storage, or cryptographic operations like encryption and decryption. To encrypt or decrypt the row key, your application has to fetch the master key from the secret manager and load it to memory. Therefore, your master key can be leaked. Major cloud providers also support this service Environment variable Least secure option, not recommended Any process or thread in your app can get the master key, They may appear in crash logs or dump files, posing a security risk Visible via /proc//environ Not Rotatable or Audited 4. Decryption Performance Concerns KMS - Key Management Service Decrypting a row key requires a network call to KMS, which may introduce latency You can mitigate this issue by securely caching the decrypted row key in memory to reuse it 5. Master Key Rotation Master key rotation can help to boost your security level. This process requires you to decrypt row keys with the old master key and re-encrypt them with a new master key. Row data remains intact since we don’t change the row key.\nSince this process can take time, so you might need to support multiple versions of the master key during rotation. Consider batch job or lazy approach to enhance the performance. 6. Additional Securing Credit Card Info Approach If you don’t have to store user credit card information, consider using a Payment Service Provider like Stripe, which handles the credit card information on your behalf.\n7. KMS is great, so why not just use it to encrypt everything? Here is the explanation from AWS:\nWhile AWS KMS does support sending data up to 4 KB to be encrypted directly, envelope encryption can offer significant performance benefits. When you encrypt data directly with AWS KMS it must be transferred over the network. Envelope encryption reduces the network load since only the request and delivery of the much smaller data key go over the network. The data key is used locally in your application or encrypting AWS service, avoiding the need to send the entire block of data to AWS KMS and suffer network latency. https://aws.amazon.com/kms/faqs/ So basically, the row key is small and safe to transmit over the network.\nSome cloud providers like AWS will throttle your requests when you exceed the default quota, like 1000 requests per second. Be aware of this, since it can become the bottleneck, and affects your application scalability.\nHSMs are usually limited to some operations and specific algorithms. Using the row key allows you to choose encryption algorithms that best fit your application’s needs.\n7. Why is it safe If you manage your master key in a proper KMS, then the chance your master key gets leaked is very low, you can also enhance master key security by doing master key rotation. The row key is more vulnerable since it must be loaded into memory by your application to decrypt data. If improper actions are taken, like showing sensitive data in system logs, it could be leaked. But if your row keys are leaked, then only the corresponding data with those leaked keys are leaked, not all since each record is protected by its own key. 8. References https://aws.amazon.com/kms/faqs/ https://docs.aws.amazon.com/kms/latest/developerguide/requests-per-second.html https://aws.amazon.com/blogs/security/are-kms-custom-key-stores-right-for-you ","wordCount":"966","inLanguage":"en","image":"https://khanh1998.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-04-11T20:56:56+07:00","dateModified":"2025-04-11T20:56:56+07:00","author":{"@type":"Person","name":"Khanh Bui"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://khanh1998.github.io/posts/envelop-encryption/"},"publisher":{"@type":"Organization","name":"Khanh1998","logo":{"@type":"ImageObject","url":"https://khanh1998.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://khanh1998.github.io/ accesskey=h title="Khanh1998 (Alt + H)"><img src=https://khanh1998.github.io/favicon.ico alt aria-label=logo height=32>Khanh1998</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://khanh1998.github.io/vi/ title="Tiếng Việt" aria-label="Tiếng Việt">Vi</a></li></ul></div></div><ul id=menu><li><a href=https://khanh1998.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://khanh1998.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://khanh1998.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://khanh1998.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://khanh1998.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Envelop Encryption</h1><div class=post-meta><span title='2025-04-11 20:56:56 +0700 +07'>April 11, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;966 words&nbsp;·&nbsp;Khanh Bui&nbsp;|&nbsp;<a href=https://github.com/khanh1998/khanh1998.github.io/blob/main/content/posts/envelop-encryption.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-data-encryption>1. Data Encryption</a></li><li><a href=#2-data-decryption>2. Data Decryption</a></li><li><a href=#3-where-to-store-master-key-kek>3. Where To Store Master Key (KEK)</a></li><li><a href=#4-decryption-performance-concerns>4. Decryption Performance Concerns</a></li><li><a href=#5-master-key-rotation>5. Master Key Rotation</a></li><li><a href=#6-additional-securing-credit-card-info-approach>6. Additional Securing Credit Card Info Approach</a></li><li><a href=#7-kms-is-great-so-why-not-just-use-it-to-encrypt-everything>7. KMS is great, so why not just use it to encrypt everything?</a></li><li><a href=#7-why-is-it-safe>7. Why is it safe</a></li><li><a href=#8-references>8. References</a></li></ul></nav></div></details></div><div class=post-content><p>To secure storing sensitive information, a common approach is to use <strong>envelope encryption</strong>:</p><ul><li>A <strong>master key</strong> (usually managed by a secure KMS)</li><li>A <strong>row-level key</strong> (used to encrypt individual records)</li><li>Each row of sensitive data (e.g., credit card information) is encrypted using a unique row key, the row key itself is encrypted using the master key and stored alongside the data in the database.</li></ul><p>This setup allows secure key rotation, better isolation, and compliance with security standards.</p><h2 id=1-data-encryption>1. Data Encryption<a hidden class=anchor aria-hidden=true href=#1-data-encryption>#</a></h2><ul><li>For an application, generate a single master key (KEK - Key Encryption Key) and store it in a safe place</li><li>For each row (e.g., credit card), we generate a unique key (DEK - Data Encryption Key)</li><li>We encrypt row data with its corresponding row key and also encrypt the row key with the master key<ul><li>we usually don&rsquo;t need to encrypt the entire row of data, just some sensitive fields are enough</li><li>for the credit card use case, we only need to encrypt the card number, cardholder name, and CVV</li><li>this keeps the encryption small and fast</li></ul></li><li>Store encrypted data and encrypted row key to the database</li></ul><h2 id=2-data-decryption>2. Data Decryption<a hidden class=anchor aria-hidden=true href=#2-data-decryption>#</a></h2><ul><li>Retrieve encrypted data and encrypted row key from the database</li><li>Decrypt row key with master key</li><li>Decrypt row data with row key</li></ul><h2 id=3-where-to-store-master-key-kek>3. Where To Store Master Key (KEK)<a hidden class=anchor aria-hidden=true href=#3-where-to-store-master-key-kek>#</a></h2><ol><li>KMS - Key Management Service<ul><li>The safest place to manage the master key</li><li>KMS is backed by a Hardware Security Module (HSM). HSM is special hardware that helps you to generate and store keys, and encrypt and decrypt data with the generated key. The generated keys will never leave the device, no one knows the key, even the administrators, it also usually comes with data tampering prevention out of the box.</li><li>Once the master key is created by KMS, you can send row keys to KMS to encrypt it. To decrypt row keys, send the encrypted row keys back to KMS, which will return the decrypted ones. The master key never leaves the HSM.</li><li>Major cloud providers all support this service</li><li>If you use KMS from the cloud providers, your master keys are generated and stored securely within their infrastructure. You can even gain more control over security with BYOE - <a href=https://aws.amazon.com/blogs/security/are-kms-custom-key-stores-right-for-you/>Bring Your Own Encryption</a>, keys now will be generated and stored in your custom HSM devices.</li><li>If you need absolute security control, host your own KMS service that is backed by HSM.</li></ul></li><li>Secrets Manager<ul><li>Not as safe as KMS</li><li>This service is meant to store API keys, passwords, certificates, and other sensitive data - not master keys (KEK)</li><li>Since it isn&rsquo;t backed by HSM, hence it doesn’t support key generation, storage, or cryptographic operations like encryption and decryption.</li><li>To encrypt or decrypt the row key, your application has to fetch the master key from the secret manager and load it to memory. Therefore, your master key can be leaked.</li><li>Major cloud providers also support this service</li></ul></li><li>Environment variable<ul><li>Least secure option, not recommended</li><li>Any process or thread in your app can get the master key,</li><li>They may appear in crash logs or dump files, posing a security risk</li><li>Visible via <code>/proc/&lt;pid>/environ</code></li><li>Not Rotatable or Audited</li></ul></li></ol><h2 id=4-decryption-performance-concerns>4. Decryption Performance Concerns<a hidden class=anchor aria-hidden=true href=#4-decryption-performance-concerns>#</a></h2><ol><li>KMS - Key Management Service<ul><li>Decrypting a row key requires a network call to KMS, which may introduce latency</li><li>You can mitigate this issue by securely caching the decrypted row key in memory to reuse it</li></ul></li></ol><h2 id=5-master-key-rotation>5. Master Key Rotation<a hidden class=anchor aria-hidden=true href=#5-master-key-rotation>#</a></h2><p>Master key rotation can help to boost your security level. This process requires you to decrypt row keys with the old master key and re-encrypt them with a new master key. Row data remains intact since we don&rsquo;t change the row key.</p><ul><li>Since this process can take time, so you might need to support multiple versions of the master key during rotation.</li><li>Consider batch job or lazy approach to enhance the performance.</li></ul><h2 id=6-additional-securing-credit-card-info-approach>6. Additional Securing Credit Card Info Approach<a hidden class=anchor aria-hidden=true href=#6-additional-securing-credit-card-info-approach>#</a></h2><p>If you don&rsquo;t have to store user credit card information, consider using a Payment Service Provider like Stripe, which handles the credit card information on your behalf.</p><h2 id=7-kms-is-great-so-why-not-just-use-it-to-encrypt-everything>7. KMS is great, so why not just use it to encrypt everything?<a hidden class=anchor aria-hidden=true href=#7-kms-is-great-so-why-not-just-use-it-to-encrypt-everything>#</a></h2><ul><li><p>Here is the explanation from AWS:</p><blockquote><p>While AWS KMS does support sending data up to 4 KB to be encrypted directly, envelope encryption can offer significant performance benefits. When you encrypt data directly with AWS KMS it must be transferred over the network. Envelope encryption reduces the network load since only the request and delivery of the much smaller data key go over the network. The data key is used locally in your application or encrypting AWS service, avoiding the need to send the entire block of data to AWS KMS and suffer network latency.
<a href=https://aws.amazon.com/kms/faqs/>https://aws.amazon.com/kms/faqs/</a>
So basically, the row key is small and safe to transmit over the network.</p></blockquote></li><li><p>Some cloud providers like AWS will throttle your requests when you exceed the <strong>default</strong> <a href=https://docs.aws.amazon.com/kms/latest/developerguide/requests-per-second.html>quota</a>, like 1000 requests per second. Be aware of this, since it can become the bottleneck, and affects your application scalability.</p></li><li><p>HSMs are usually limited to some operations and specific algorithms. Using the row key allows you to choose encryption algorithms that best fit your application&rsquo;s needs.</p></li></ul><h2 id=7-why-is-it-safe>7. Why is it safe<a hidden class=anchor aria-hidden=true href=#7-why-is-it-safe>#</a></h2><ul><li>If you manage your master key in a proper KMS, then the chance your master key gets leaked is very low, you can also enhance master key security by doing master key rotation.</li><li>The row key is more vulnerable since it must be loaded into memory by your application to decrypt data. If improper actions are taken, like showing sensitive data in system logs, it could be leaked.</li><li>But if your row keys are leaked, then only the corresponding data with those leaked keys are leaked, not all since each record is protected by its own key.</li></ul><h2 id=8-references>8. References<a hidden class=anchor aria-hidden=true href=#8-references>#</a></h2><ul><li><a href=https://aws.amazon.com/kms/faqs/>https://aws.amazon.com/kms/faqs/</a></li><li><a href=https://docs.aws.amazon.com/kms/latest/developerguide/requests-per-second.html>https://docs.aws.amazon.com/kms/latest/developerguide/requests-per-second.html</a></li><li><a href=https://aws.amazon.com/blogs/security/are-kms-custom-key-stores-right-for-you>https://aws.amazon.com/blogs/security/are-kms-custom-key-stores-right-for-you</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://khanh1998.github.io/tags/cs/>Cs</a></li><li><a href=https://khanh1998.github.io/tags/encryption/>Encryption</a></li></ul><nav class=paginav><a class=prev href=https://khanh1998.github.io/posts/orverview-of-hdd-and-ssd/><span class=title>« Prev</span><br><span>Overview of HDD and SSD</span>
</a><a class=next href=https://khanh1998.github.io/posts/postgres-advisory-locks/><span class=title>Next »</span><br><span>Postgres Advisory Locks</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Envelop Encryption on x" href="https://x.com/intent/tweet/?text=Envelop%20Encryption&amp;url=https%3a%2f%2fkhanh1998.github.io%2fposts%2fenvelop-encryption%2f&amp;hashtags=cs%2cencryption"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Envelop Encryption on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fkhanh1998.github.io%2fposts%2fenvelop-encryption%2f&amp;title=Envelop%20Encryption&amp;summary=Envelop%20Encryption&amp;source=https%3a%2f%2fkhanh1998.github.io%2fposts%2fenvelop-encryption%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Envelop Encryption on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fkhanh1998.github.io%2fposts%2fenvelop-encryption%2f&title=Envelop%20Encryption"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Envelop Encryption on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fkhanh1998.github.io%2fposts%2fenvelop-encryption%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Envelop Encryption on whatsapp" href="https://api.whatsapp.com/send?text=Envelop%20Encryption%20-%20https%3a%2f%2fkhanh1998.github.io%2fposts%2fenvelop-encryption%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Envelop Encryption on telegram" href="https://telegram.me/share/url?text=Envelop%20Encryption&amp;url=https%3a%2f%2fkhanh1998.github.io%2fposts%2fenvelop-encryption%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Envelop Encryption on ycombinator" href="https://news.ycombinator.com/submitlink?t=Envelop%20Encryption&u=https%3a%2f%2fkhanh1998.github.io%2fposts%2fenvelop-encryption%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//khanh1998.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://khanh1998.github.io/>Khanh1998</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>